# PowerShell ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ´Ğ»Ñ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ²ÑĞµÑ… Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ñ‹Ñ… ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²
# Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ: .\scripts\stop-servers.ps1

Write-Host ""
Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
Write-Host "ğŸ›‘ SLIME ARENA â€” ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ° ÑĞµÑ€Ğ²ĞµÑ€Ğ¾Ğ²" -ForegroundColor Cyan
Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
Write-Host ""

$portsToKill = @(2567, 5173)
$processesKilled = $false

foreach ($port in $portsToKill) {
    Write-Host "ğŸ” ĞŸĞ¾Ğ¸ÑĞº Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ñƒ $port..." -ForegroundColor Yellow
    
    try {
        $connection = Get-NetTCPConnection -LocalPort $port -ErrorAction SilentlyContinue
        
        if ($connection) {
            $process = Get-Process -Id $connection.OwningProcess -ErrorAction SilentlyContinue
            
            if ($process) {
                Write-Host "   ĞĞ°Ğ¹Ğ´ĞµĞ½ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ: $($process.ProcessName) (PID: $($process.Id))" -ForegroundColor Yellow
                Write-Host "   ĞÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°..." -ForegroundColor Yellow
                
                Stop-Process -Id $process.Id -Force -ErrorAction SilentlyContinue
                
                Write-Host "   âœ“ ĞŸÑ€Ğ¾Ñ†ĞµÑÑ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½" -ForegroundColor Green
                $processesKilled = $true
            }
        } else {
            Write-Host "   âœ“ ĞŸÑ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾" -ForegroundColor Green
        }
    } catch {
        Write-Host "   âš ï¸  ĞÑˆĞ¸Ğ±ĞºĞ°: $_" -ForegroundColor Yellow
    }
    
    Write-Host ""
}

if ($processesKilled) {
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
    Write-Host "âœ… Ğ’ÑĞµ ÑĞµÑ€Ğ²ĞµÑ€Ñ‹ Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ñ‹!" -ForegroundColor Green
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
} else {
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
    Write-Host "â„¹ï¸  ĞĞµÑ‚ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑĞ¾Ğ² Ğ½Ğ° Ğ¿Ğ¾Ñ€Ñ‚Ğ°Ñ… 2567, 5173" -ForegroundColor Blue
    Write-Host "â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" -ForegroundColor Cyan
}

Write-Host ""
