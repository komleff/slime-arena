# Техническая спецификация проекта Slime Arena

## Версия документа: 1.0
## Дата: 2025-12-21

---

## 1. Введение

### 1.1 Цель документа
Данный документ описывает техническую спецификацию игры Slime Arena, включая требования, архитектуру и реализацию.

### 1.2 Область применения
Документ предназначен для разработчиков, тестировщиков и контрибьюторов проекта.

### 1.3 Определения и аббревиатуры
- **FPS** - Frames Per Second (кадров в секунду)
- **ECS** - Entity Component System
- **AI** - Artificial Intelligence
- **HUD** - Heads-Up Display
- **UI** - User Interface
- **CI/CD** - Continuous Integration/Continuous Deployment

---

## 2. Обзор продукта

### 2.1 Описание игры
Slime Arena - аркадная игра в жанре арена-файтинг, где игрок сражается с бесконечными волнами слаймов, набирает очки и улучшает своего персонажа.

### 2.2 Целевая аудитория
- Казуальные игроки
- Фанаты аркадных экшн-игр
- Игроки, любящие простой, но захватывающий геймплей
- Возраст: 10+

### 2.3 Платформы
- **Основная**: Веб-браузеры (Chrome, Firefox, Safari, Edge)
- **Планируется**: Мобильные устройства (Android, iOS)
- **Возможно**: Desktop (через Electron)

---

## 3. Функциональные требования

### 3.1 Основной геймплей

#### 3.1.1 Управление игроком
**FR-001**: Игрок должен управляться с помощью клавиатуры и мыши
- **Приоритет**: Высокий
- **Описание**: 
  - WASD/Стрелки - движение
  - Мышь - прицеливание
  - ЛКМ - атака
  - Пробел - специальная способность
  - ESC - пауза

#### 3.1.2 Боевая система
**FR-002**: Система атаки должна быть отзывчивой и интуитивной
- **Приоритет**: Высокий
- **Описание**:
  - Различные типы оружия
  - Система урона и здоровья
  - Визуальная обратная связь при попадании
  - Звуковые эффекты

#### 3.1.3 Система врагов
**FR-003**: Должны быть различные типы врагов с уникальным поведением
- **Приоритет**: Средний
- **Типы врагов**:
  - Базовый слайм - медленный, слабый
  - Быстрый слайм - быстрый, слабый
  - Танк-слайм - медленный, прочный
  - Взрывной слайм - взрывается при смерти
  - Босс-слайм - большой и сильный

#### 3.1.4 Система волн
**FR-004**: Враги должны появляться волнами возрастающей сложности
- **Приоритет**: Высокий
- **Описание**:
  - Волны с паузами между ними
  - Постепенное увеличение количества врагов
  - Появление новых типов врагов
  - Бонусное время для подготовки

### 3.2 Прогрессия и улучшения

#### 3.2.1 Система опыта
**FR-005**: Игрок должен получать опыт за убийство врагов
- **Приоритет**: Средний
- **Описание**:
  - Очки опыта за каждого врага
  - Система уровней
  - Выбор улучшений при повышении уровня

#### 3.2.2 Улучшения
**FR-006**: Доступные улучшения для персонажа
- **Приоритет**: Средний
- **Типы улучшений**:
  - Увеличение здоровья
  - Увеличение скорости
  - Увеличение урона
  - Скорость атаки
  - Дополнительное оружие

### 3.3 Интерфейс пользователя

#### 3.3.1 Главное меню
**FR-007**: Главное меню должно содержать
- Начать игру
- Настройки
- Таблица лидеров
- Выход

#### 3.3.2 HUD
**FR-008**: HUD должен отображать
- Текущее здоровье
- Текущий счет
- Номер волны
- Уровень персонажа
- Таймер до следующей волны

#### 3.3.3 Меню паузы
**FR-009**: Меню паузы должно позволять
- Продолжить игру
- Настройки
- Выход в главное меню

### 3.4 Сохранение данных

#### 3.4.1 Локальное сохранение
**FR-010**: Игра должна сохранять
- **Приоритет**: Низкий
- Лучший результат
- Настройки игры
- Статистика (всего убито врагов, сыграно игр и т.д.)

### 3.5 Звук и музыка

#### 3.5.1 Звуковые эффекты
**FR-011**: Необходимы звуковые эффекты для
- **Приоритет**: Низкий
- Выстрелов
- Попаданий
- Смерти врагов
- Получения урона
- Повышения уровня
- UI взаимодействий

#### 3.5.2 Музыка
**FR-012**: Фоновая музыка для
- Главного меню
- Игрового процесса
- Экрана окончания игры

---

## 4. Нефункциональные требования

### 4.1 Производительность

#### 4.1.1 Скорость работы
**NFR-001**: Игра должна работать с частотой минимум 60 FPS
- **Целевые платформы**: Desktop браузеры
- **Минимум**: 30 FPS на мобильных устройствах

#### 4.1.2 Время загрузки
**NFR-002**: Начальная загрузка не должна превышать 5 секунд
- На средней скорости интернета (10 Mbps)

#### 4.1.3 Использование памяти
**NFR-003**: Игра не должна использовать более 200MB RAM

### 4.2 Масштабируемость

**NFR-004**: Архитектура должна позволять легко добавлять:
- Новые типы врагов
- Новое оружие
- Новые улучшения
- Новые механики

### 4.3 Надежность

**NFR-005**: Игра должна корректно обрабатывать ошибки
- Отсутствие критических багов
- Graceful degradation при проблемах с ресурсами
- Автосохранение при закрытии

### 4.4 Совместимость

**NFR-006**: Поддержка браузеров
- Chrome 100+
- Firefox 100+
- Safari 15+
- Edge 100+

**NFR-007**: Адаптивность
- Desktop: 1280x720 минимум
- Tablet: 768x1024
- Mobile: 375x667 минимум

### 4.5 Удобство использования

**NFR-008**: Простота освоения
- Туториал для новых игроков
- Интуитивное управление
- Понятный UI

### 4.6 Безопасность

**NFR-009**: Защита данных
- Валидация всех входных данных
- Защита от XSS
- Безопасное хранение данных в localStorage
- Отсутствие хардкод секретов в коде

### 4.7 Доступность

**NFR-010**: Игра должна быть доступна
- Поддержка клавиатурной навигации
- Возможность настройки управления
- Регулировка громкости звуков отдельно

---

## 5. Технические требования

### 5.1 Технологический стек

#### Рекомендуемый стек:
```
Frontend:
- TypeScript 5.0+
- Phaser 3.60+
- Vite 5.0+

Testing:
- Jest 29+
- @testing-library/dom

Code Quality:
- ESLint 8+
- Prettier 3+
- TypeScript Strict Mode

CI/CD:
- GitHub Actions
- Dependabot

Hosting:
- GitHub Pages / Netlify / Vercel
```

### 5.2 Структура файлов

```
slime-arena/
├── .github/
│   └── workflows/
│       └── ci-cd.yml
├── src/
│   ├── config/
│   │   ├── game-config.ts
│   │   ├── balance.ts
│   │   └── assets-config.ts
│   ├── entities/
│   │   ├── Entity.ts
│   │   ├── Player.ts
│   │   ├── enemies/
│   │   │   ├── Enemy.ts
│   │   │   ├── BasicSlime.ts
│   │   │   ├── FastSlime.ts
│   │   │   └── TankSlime.ts
│   │   ├── Projectile.ts
│   │   └── PowerUp.ts
│   ├── scenes/
│   │   ├── BootScene.ts
│   │   ├── MenuScene.ts
│   │   ├── GameScene.ts
│   │   ├── PauseScene.ts
│   │   └── GameOverScene.ts
│   ├── systems/
│   │   ├── PhysicsSystem.ts
│   │   ├── CollisionSystem.ts
│   │   ├── AISystem.ts
│   │   ├── SpawnSystem.ts
│   │   └── InputSystem.ts
│   ├── ui/
│   │   ├── HUD.ts
│   │   ├── Menu.ts
│   │   └── Dialog.ts
│   ├── utils/
│   │   ├── Vector2.ts
│   │   ├── EventBus.ts
│   │   ├── ObjectPool.ts
│   │   └── QuadTree.ts
│   ├── managers/
│   │   ├── AssetManager.ts
│   │   ├── AudioManager.ts
│   │   ├── SaveManager.ts
│   │   └── ScoreManager.ts
│   ├── types/
│   │   └── index.ts
│   └── main.ts
├── assets/
│   ├── sprites/
│   ├── audio/
│   │   ├── sfx/
│   │   └── music/
│   └── fonts/
├── public/
│   ├── index.html
│   └── favicon.ico
├── tests/
│   ├── unit/
│   ├── integration/
│   └── e2e/
├── docs/
│   ├── API.md
│   └── GAMEPLAY.md
├── .gitignore
├── .eslintrc.json
├── .prettierrc
├── tsconfig.json
├── vite.config.ts
├── package.json
├── README.md
├── CODE_REVIEW.md
├── CONTRIBUTING.md
├── ARCHITECTURE.md
├── SECURITY.md
└── TECHNICAL_SPEC.md (этот файл)
```

### 5.3 Системные требования

#### Минимальные:
- Процессор: 1.5 GHz двухъядерный
- ОЗУ: 2 GB
- Видеокарта: Поддержка WebGL 2.0
- Браузер: Chrome 100+, Firefox 100+, Safari 15+, Edge 100+
- Интернет: 5 Mbps для первой загрузки

#### Рекомендуемые:
- Процессор: 2.5 GHz четырехъядерный
- ОЗУ: 4 GB
- Видеокарта: Поддержка WebGL 2.0 с аппаратным ускорением
- Браузер: Последние версии
- Интернет: 10 Mbps

---

## 6. Игровая механика

### 6.1 Физика и движение

#### 6.1.1 Движение игрока
- Максимальная скорость: 200 пикселей/секунду
- Ускорение: 800 пикселей/секунду²
- Трение: 0.9 (коэффициент)

#### 6.1.2 Снаряды
- Скорость: 400 пикселей/секунду
- Время жизни: 3 секунды
- Размер: 8x8 пикселей

### 6.2 Баланс игры

#### 6.2.1 Игрок
```typescript
{
  health: 100,
  maxHealth: 100,
  speed: 200,
  damage: 10,
  attackSpeed: 1.0, // атак в секунду
  critChance: 0.05, // 5%
  critMultiplier: 2.0
}
```

#### 6.2.2 Враги

**Базовый слайм:**
```typescript
{
  health: 30,
  speed: 50,
  damage: 10,
  scoreValue: 10,
  spawnWeight: 1.0
}
```

**Быстрый слайм:**
```typescript
{
  health: 20,
  speed: 150,
  damage: 5,
  scoreValue: 15,
  spawnWeight: 0.7
}
```

**Танк-слайм:**
```typescript
{
  health: 100,
  speed: 30,
  damage: 20,
  scoreValue: 30,
  spawnWeight: 0.3
}
```

### 6.3 Система волн

#### 6.3.1 Формула сложности
```typescript
waveEnemies = baseEnemies + (waveNumber * scalingFactor)
enemyHealth = baseHealth * (1 + waveNumber * 0.1)
enemyDamage = baseDamage * (1 + waveNumber * 0.05)
```

#### 6.3.2 Параметры
- `baseEnemies`: 5
- `scalingFactor`: 2
- Пауза между волнами: 15 секунд
- Новый тип врага каждые 5 волн

---

## 7. API и интеграции

### 7.1 Внутреннее API

#### 7.1.1 Event Bus
```typescript
interface GameEvents {
  'enemy:killed': (enemy: Enemy) => void;
  'player:hit': (damage: number) => void;
  'wave:complete': (waveNumber: number) => void;
  'game:over': (score: number) => void;
  'powerup:collected': (type: PowerUpType) => void;
}
```

#### 7.1.2 Save Manager
```typescript
interface SaveData {
  highScore: number;
  settings: GameSettings;
  statistics: GameStatistics;
}
```

### 7.2 Внешние интеграции (планируется)

#### 7.2.1 Таблица лидеров
- REST API для сохранения/загрузки результатов
- Аутентификация через OAuth (опционально)

#### 7.2.2 Аналитика
- Интеграция с Google Analytics
- Отслеживание игровых метрик

---

## 8. Тестирование

### 8.1 Unit тесты

Минимальное покрытие: 70%

**Приоритетные модули для тестирования:**
- Системы (Physics, Collision, AI)
- Утилиты (Vector2, ObjectPool, QuadTree)
- Менеджеры (Score, Save)

### 8.2 Integration тесты

Тестирование взаимодействия:
- Игрок и враги
- Снаряды и коллизии
- Система спавна и волн

### 8.3 E2E тесты

Тестирование полного игрового процесса:
- Запуск игры
- Прохождение нескольких волн
- Смерть игрока
- Сохранение результата

### 8.4 Performance тесты

- FPS при разном количестве врагов
- Время загрузки ресурсов
- Использование памяти

---

## 9. Развертывание

### 9.1 CI/CD Pipeline

```yaml
1. Lint → 2. Test → 3. Build → 4. Security Scan → 5. Deploy
```

### 9.2 Окружения

- **Development**: Локальная разработка
- **Staging**: Тестовый сервер (Netlify preview)
- **Production**: Основной сайт (GitHub Pages / Netlify)

### 9.3 Версионирование

Семантическое версионирование: MAJOR.MINOR.PATCH
- **MAJOR**: Серьезные изменения API/геймплея
- **MINOR**: Новые функции
- **PATCH**: Исправления багов

---

## 10. Мониторинг и поддержка

### 10.1 Логирование

- Уровни: ERROR, WARN, INFO, DEBUG
- Отправка критических ошибок на сервер

### 10.2 Метрики

- Активные игроки
- Средняя продолжительность сессии
- Самая популярная волна (где умирают)
- Самое используемое улучшение

### 10.3 Обратная связь

- GitHub Issues для багов
- Discord/форум для обсуждений (опционально)

---

## 11. Дорожная карта

### Фаза 1: MVP (1-2 месяца)
- ✅ Базовая документация
- ⬜ Выбор технологий
- ⬜ Базовый игрок
- ⬜ Простые враги
- ⬜ Система столкновений
- ⬜ Базовая боевая система

### Фаза 2: Core Gameplay (2-3 месяца)
- ⬜ Разные типы врагов
- ⬜ Система волн
- ⬜ HUD и UI
- ⬜ Система улучшений

### Фаза 3: Полировка (1-2 месяца)
- ⬜ Звуки и музыка
- ⬜ Визуальные эффекты
- ⬜ Анимации
- ⬜ Туториал

### Фаза 4: Релиз (1 месяц)
- ⬜ Балансировка
- ⬜ Оптимизация
- ⬜ Тестирование
- ⬜ Публикация

---

## 12. Риски и ограничения

### 12.1 Технические риски

| Риск | Вероятность | Влияние | Митигация |
|------|-------------|---------|-----------|
| Проблемы производительности | Средняя | Высокое | Object pooling, профилирование |
| Сложность AI врагов | Низкая | Среднее | Начать с простого поведения |
| Кроссбраузерность | Средняя | Среднее | Использование Phaser 3 |

### 12.2 Ограничения

- Однопользовательская игра (на первой стадии)
- Только веб-платформа изначально
- Ограниченное количество типов врагов в MVP

---

## 13. Заключение

Данная техническая спецификация является живым документом и будет обновляться по мере развития проекта. Все предложения по улучшению приветствуются через GitHub Issues.

---

**Версия**: 1.0  
**Дата**: 2025-12-21  
**Авторы**: GitHub Copilot Agent, komleff  
**Статус**: Draft
