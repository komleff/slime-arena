# Slime Arena — UI

**Версия:** 3.3.2  
**Дата:** 03.01.2026  
**Зависимости:** GDD-Core.md (классы, GCD), GDD-Chests.md (усиления)  
**Глоссарий:** [GDD-Glossary.md](GDD-Glossary.md)

---

## 1. Экран игры

### 1.1. Основные элементы

| Элемент | Расположение | Описание |
|---|---|---|
| Масса и уровень | Левый верхний угол | Число килограммов и полоса до следующего уровня |
| Мини-карта | Правый верхний угол | Зоны, сундуки, метка лидера |
| Умения | Нижний правый угол | 1–3 иконки с индикаторами перезарядки |
| Джойстик | Нижний левый угол | Адаптивный, появляется под пальцем |
| Карточки выбора | Правый край, середина | При наличии выбора (поверх умений) |
| Индикатор очереди | Над умениями | Количество отложенных выборов |
| Таймер матча | Верхняя часть, центр | Оставшееся время |
| Счётчик убийств | Под таймером | Количество убийств игрока |

### 1.2. Приоритет отображения

Карточки выбора отображаются поверх иконок умений. Иконки умений в это время затемняются.

---

## 2. Джойстик

### 2.1. Тип

Адаптивный джойстик — появляется под пальцем в момент касания.

### 2.2. Поведение

- Касание в левой нижней зоне экрана создаёт джойстик.
- Центр джойстика — точка касания.
- Смещение пальца от центра определяет направление движения.
- При отпускании джойстик исчезает.

### 2.3. Управление слаймом

- Направление джойстика задаёт целевой курс.
- Величина смещения определяет мощность тяги.
- FlightAssist автоматически поворачивает слайм к целевому курсу.

---

## 3. Индикатор умения

### 3.1. Содержимое

- Иконка умения
- Стоимость в процентах массы
- Полоса перезарядки

### 3.2. Состояния

| Состояние | Отображение |
|---|---|
| Готово | Яркая иконка, полная полоса |
| Перезарядка | Затемнённая иконка, полоса заполняется |
| Недостаточно массы | Красная рамка |

### 3.3. Расположение

- Нижний правый угол экрана.
- 1–3 иконки в зависимости от количества слотов.
- Расстояние между иконками достаточное для касания без промахов.

---

## 4. Мини-карта

### 4.1. Показывает

- Границы карты
- **Метка игрока** (центрированная точка или стрелка)
- **Границы видимой области** (прямоугольник вокруг метки игрока)
- Пузыри крупного размера
- **Сундуки** (видны всем игрокам глобально)
- Цветные области зон
- Мигающие безопасные зоны (в последние 60 секунд)
- Метку лидера (Короля) в виде короны
- Стрелку к ближайшей безопасной зоне

### 4.2. Не показывает

- Других игроков, кроме Короля
- Мелкие пузыри
- Препятствия

### 4.3. Размер

- Правый верхний угол
- Занимает около 15% ширины экрана
- Полупрозрачный фон

---

## 5. Автомасштабирование камеры

### 5.1. Проблема

При значительном увеличении массы слайм становится большим. Если камера не масштабируется, слайм занимает весь экран.

### 5.2. Решение

Камера плавно отдаляется при росте слайма, сохраняя игровое поле читаемым.

### 5.3. Параметры

| Параметр | Значение |
|---|---|
| Минимальный зум (при 100 кг) `cameraZoomMin` | 1.0 |
| Максимальный зум (при 2000+ кг) `cameraZoomMax` | 2.5 |
| Скорость изменения зума `cameraZoomSpeed` | 0.5 ед/сек |

### 5.4. Формула зума

```
cameraZoom = 1.0 + 0.3 × log₂(mass / 100)
```

| Масса | Зум |
|---:|---:|
| 100 кг | 1.0 |
| 400 кг | 1.6 |
| 1600 кг | 2.2 |

### 5.5. Визуальная обратная связь

Чтобы игрок понимал, что он вырос (а не камера отъехала):
- **Видимый размер слайма слегка растёт** (не уменьшается!)
- **Координатная сетка на фоне** — при отдалении сетка становится мельче
- **Плавность** — зум меняется за 1–2 сек, не мгновенно
- **Не мешать управлению** — зум не меняется во время активного боя (cooldown 3 сек после урона)

### 5.6. Приоритеты

1. Слайм всегда виден полностью.
2. Видимый размер слайма не уменьшается (может слегка расти).
3. Зум не мешает геймплею.

### 5.7. Учёт зума в Input

При изменении зума координаты касания относительно мира меняются. InputTranslator учитывает текущий `cameraZoom` при переводе экранных координат в мировые.

---

## 6. Карточки выбора

### 6.1. Расположение

Правая часть экрана.

### 6.2. Развёрнутое состояние

- 3 вертикальные карточки
- Полупрозрачность 50%
- Занимают около 20% ширины экрана
- Иконки умений внизу затемняются

### 6.3. Свёрнутое состояние

- Через 3 сек бездействия карточки сворачиваются
- Остаётся мигающий значок с количеством отложенных выборов
- Касание значка разворачивает карточки

### 6.4. При получении урона

Автоматическое сворачивание. Выбор сохраняется в очереди.

### 6.5. Содержимое карточки

- Крупная иконка
- Название (одна строка)
- Эффект с числовыми значениями (одна строка)
- Цвет рамки по редкости: серый, синий, фиолетовый

### 6.6. Управление

| Действие | Результат |
|---|---|
| Касание карточки | Выбор |
| Смахивание влево | Сворачивание |
| Касание значка очереди | Разворачивание |

---

## 7. Индикатор очереди выборов

### 7.1. Расположение

Над иконками умений.

### 7.2. Отображение

- Мигающий значок при наличии отложенных выборов.
- Число — количество элементов в очереди (1–3).
- Круговой таймер вокруг значка (до автовыбора).

### 7.3. Взаимодействие

Касание значка разворачивает карточки.

---

## 8. Уведомления

### 8.1. Типы уведомлений

| Событие | Отображение | Длительность |
|---|---|---:|
| Убийство | Текст в центре | 1 сек |
| Гибель | Текст и затемнение | 0.5 сек |
| Новый уровень | Текст и звук | 1 сек |
| Вне безопасной зоны | Пульсация краёв экрана | Постоянно |
| Появился сундук | Звук и свечение на мини-карте | 3 сек |
| Получено усиление | Иконка + текст, смещение вверх | 1.5 сек |
| Получен талант | Иконка + название + эффект | 2 сек |

### 8.2. Приоритет уведомлений

1. Гибель (высший)
2. Убийство
3. Вне безопасной зоны
4. Новый уровень
5. Усиление/талант (низший)

---

## 9. Визуализация усилений на слайме

### 9.1. Принцип разделения слоёв (2D, вид сверху)

| Слой | Порядок отрисовки | Что занимает |
|---|---|---|
| Под спрайтом | Самый нижний | Кольца Магнита, Притяжения |
| Свечение спрайта | Подложка | Берсерк (красное) |
| Спрайт слайма | Основной | — |
| Контур спрайта | Обводка | Защита (золотой), Щит (голубой) |
| Частицы вокруг | Поверх спрайта | Ярость, Жадность |
| След движения | За спрайтом | Ускорение |
| Иконка-индикатор | Справа от спрайта | Активные усиления |

### 9.2. Визуал усилений

| Усиление | Визуальный эффект | Слой |
|---|---|---|
| Ярость | Оранжевые искры вокруг слайма, пульсация спрайта | Частицы вокруг |
| Ускорение | Голубые линии скорости позади слайма при движении | След движения |
| Защита | Золотой мерцающий контур вокруг спрайта | Контур спрайта |
| Жадность | Мелкие золотые монеты вращаются вокруг слайма | Частицы вокруг |

### 9.3. Совместимость с постоянными эффектами

| Эффект | Слой | Цвет | Не конфликтует с |
|---|---|---|---|
| Берсерк | Свечение | Красный | Всё остальное (разные слои) |
| Щит (умение) | Контур | Голубой полупрозрачный | Защита — разные цвета контура |
| Магнит | Под спрайтом | Синее кольцо | Притяжение — разные умения |
| Притяжение | Под спрайтом | Фиолетовое кольцо | — |

### 9.4. Правило наложения контуров

- Щит + Защита одновременно: двойной контур (голубой внутри, золотой снаружи).
- Ярость + Жадность одновременно: искры оранжевые, монеты золотые, разные паттерны движения.

### 9.5. Иконки-индикаторы

- Маленькие иконки активных усилений справа от слайма.
- Не перекрывают спрайт.
- Видны только владельцу (не засоряют экран для других игроков).

---

## 10. Отображение слайма

### 10.1. Зоны

| Элемент | Угол | Цвет/Отображение |
|---|---|---|
| Пасть | 120° спереди | Более светлый оттенок |
| Бока | По 60° с каждой стороны | Основной цвет |
| Хвост | 120° сзади | Более тёмный оттенок |

### 10.2. Цвета классов

| Класс | Основной цвет | Оттенок пузырей |
|---|---|---|
| Охотник | Зелёный | Зелёный |
| Воин | Красный | Красный |
| Собиратель | Синий | Синий |

### 10.3. Статус Короля

- Корона над слаймом.
- Золотое свечение контура.
- Видно всем игрокам.

### 10.4. Имя игрока

- Отображается над слаймом.
- Скрывается при невидимости.

---

## 11. Индикатор усилений в интерфейсе

### 11.1. Расположение

Рядом с полосой массы (левый верхний угол).

### 11.2. Содержимое

- Маленькая иконка усиления.
- Круговой таймер вокруг иконки (заполнение против часовой стрелки).
- Для Защиты и Жадности: счётчик оставшихся зарядов вместо таймера.

### 11.3. Множественные усиления

- Иконки выстраиваются в ряд.
- Максимум 4 одновременных усиления.

---

## 12. Экран результатов

### 12.1. Содержимое

| Элемент | Описание |
|---|---|
| Таблица лидеров | Топ-10 по массе |
| Масса игрока | Число килограммов |
| Убийства | Количество убийств |
| Победитель | Выделен золотой рамкой |
| Личная статистика | Место, масса, убийства, собранные пузыри |

### 12.2. Длительность

| Параметр | Значение |
|---|---|
| `resultsDurationSec` | 12 сек |

### 12.3. Таймер

- Обратный отсчёт до следующего матча.
- Отображается в верхней части экрана.

### 12.4. Действия игрока

| Элемент | Действие |
|---|---|
| Выбор класса | Три кнопки (Охотник/Воин/Собиратель) |
| Кнопка «Выйти» | Возврат в главное меню |
| Автостарт | По истечении таймера |

---

## 13. Экран лобби

### 13.1. Назначение

Экран выбора класса перед входом в матч.

### 13.2. Элементы

| Элемент | Описание |
|---|---|
| Выбор класса | Три карточки с описанием |
| Кнопка «В бой» | Запуск поиска/присоединения |
| Таймер матча | Время до старта (если ожидание) |
| Количество игроков | Текущее/максимальное |

### 13.3. Карточка класса

- Иконка класса
- Название
- Пассивный бонус
- Пассивный штраф (если есть)
- Стартовое умение
- Цвет пузырей

### 13.4. Поведение

- При нажатии «В бой» игрок присоединяется к матчу.
- Если матч уже идёт (`Running`) — игрок появляется сразу.
- Если матч в состоянии `Results` — игрок ждёт следующего.
- Если матч в состоянии `Lobby` — игрок ждёт набора игроков.

---

## Связанные документы

- [GDD-Core.md](GDD-Core.md) — основные правила
- [GDD-Talents.md](GDD-Talents.md) — таланты
- [GDD-Chests.md](GDD-Chests.md) — сундуки и усиления
