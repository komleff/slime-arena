# Slime Arena — Talents

**Версия:** 3.3  
**Дата:** 28.12.2025  
**Зависимости:** GDD-Core.md (классы), GDD-Abilities.md (умения), GDD-Combat.md (урон)  
**Глоссарий:** [GDD-Glossary.md](GDD-Glossary.md)  

---

## 1. Общие правила

### 1.1. Редкости

| Редкость | Цвет рамки | Источник |
|---|---|---|
| Обычный | Серый | Карточки, сундуки |
| Редкий | Синий | Карточки, сундуки |
| Эпический | Фиолетовый | Карточки, сундуки |

### 1.2. Уровни талантов

- По умолчанию `talentMaxLevel = 1`.
- Часть талантов имеет уровни 1–3 или 1–2.
- При повторном получении таланта увеличивается `talentLevel`.
- Таланты без улучшений при повторном выпадении не показываются.

### 1.3. Требования

Некоторые таланты требуют наличия определённого умения. Такие таланты показываются только при выполненном условии.

---

## 2. Обычные таланты

| Талант | Эффект | Уровни |
|---|---|---:|
| Быстрые ноги | Бонус к лимиту максимальной скорости | 3 |
| Юла | Бонус к мощности поворотных двигателей | 3 |
| Острые зубы | Бонус к урону укусом | 3 |
| Обжора | Бонус к массе от пузырей | 3 |
| Толстая шкура | Снижение потерь от укусов | 3 |
| Экономный | Снижение стоимости умений | 3 |
| Перезарядка | Снижение перезарядок умений | 3 |
| Агрессор | Бонус к урону, штраф к получаемым потерям | 1 |
| Стойкий | Снижение потерь от всех источников | 1 |
| Ускоритель | Бонус к мощности маршевого двигателя | 1 |
| Якорь | Бонус к мощности тормозного двигателя | 1 |
| Краб | Бонус к мощности боковых двигателей | 1 |
| Чутьё | Видеть сундуки до появления | 2 |
| Кровожадность | Бонус массы от убийств | 1 |
| Регенерация | Восстановление массы вне боя | 2 |
| Второе дыхание | Возрождение с повышенной массой | 1 |

### 2.1. Таблица уровней обычных талантов

| Талант | Уровень 1 | Уровень 2 | Уровень 3 |
|---|---|---|---|
| Быстрые ноги | +10% макс. скорость | +18% макс. скорость | +25% макс. скорость |
| Юла | +10% поворот | +18% поворот | +25% поворот |
| Острые зубы | +15% урон укусом | +25% урон укусом | +35% урон укусом |
| Обжора | +20% масса от пузырей | +35% масса от пузырей | +50% масса от пузырей |
| Толстая шкура | −12% потери от укусов | −20% потери от укусов | −27% потери от укусов |
| Экономный | −15% стоимость умений | −25% стоимость умений | −33% стоимость умений |
| Перезарядка | −15% перезарядки | −25% перезарядки | −33% перезарядки |
| Чутьё | Сундуки за 2 сек | Сундуки за 5 сек | — |
| Регенерация | +1% за 5 сек вне боя | +1% за 4 сек вне боя | — |

### 2.2. Одноуровневые обычные таланты

| Талант | Эффект |
|---|---|
| Агрессор | +12% к урону, +12% к потере массы |
| Стойкий | −10% к потере массы |
| Ускоритель | +15% к мощности маршевого двигателя |
| Якорь | +20% к мощности тормозного двигателя |
| Краб | +15% к мощности боковых двигателей |
| Кровожадность | +15% массы от убийств |
| Второе дыхание | Возрождение с 150 кг вместо 100 кг |

**Примечание по скорости:** «Быстрые ноги» повышает лимит максимальной скорости. Сама скорость достигается ускорением от двигателей.

**Регенерация:** вне боя означает отсутствие урона от врагов в течение 3 секунд.

---

## 3. Редкие таланты

| Талант | Эффект | Требование | Уровни |
|---|---|---|---:|
| Яд | Укус отравляет (потеря массы) | — | 2 |
| Мороз | Укус замедляет | — | 2 |
| Вампир | Увеличенная доля массы от укуса слайма | — | 1 |
| Вакуум | Пузыри летят к пасти | — | 2 |
| Мотор | Бонус ко всем двигателям | — | 1 |
| Рикошет | Выброс отскакивает от стен | Есть Выброс | 1 |
| Пробивание | Выброс проходит сквозь первую цель | Есть Выброс | 1 |
| Длинный рывок | Увеличенная дистанция Рывка | Есть Рывок | 1 |
| Иглы назад | При гибели снаряды из хвоста | — | 1 |
| Токсичный | Увеличенная посмертная лужа | — | 1 |

### 3.1. Таблица уровней редких талантов

| Талант | Уровень 1 | Уровень 2 |
|---|---|---|
| Яд | 2% в сек, 3 сек | 3% в сек, 3 сек |
| Мороз | −30% скорости, 2 сек | −40% скорости, 2.5 сек |
| Вакуум | Радиус 40 м, 15 м/с | Радиус 60 м, 20 м/с |

### 3.2. Одноуровневые редкие таланты

| Талант | Эффект |
|---|---|
| Вампир | Доля массы от укуса: бок 10%→20%, хвост 15%→25% |
| Мотор | +25% к мощности всех двигателей |
| Рикошет | Выброс отскакивает от стен один раз |
| Пробивание | Выброс: 100% урона первой цели, 60% второй |
| Длинный рывок | +40% к дистанции Рывка |
| Иглы назад | При гибели 3 снаряда из хвоста, урон 10% массы атакующего |
| Токсичный | Радиус посмертной лужи ×2.0 (20 м → 40 м) |

---

## 4. Эпические таланты

| Талант | Эффект | Требование |
|---|---|---|
| Молния | +25% к скорости, укусы оглушают на 0.3 сек | — |
| Двойная активация | Повторная активация умения за 1.0 сек | — |
| Взрыв | При гибели отталкивание + урон 8% в радиусе 60 м | — |
| Левиафан | Размер ×1.3, пасть ×1.5 при той же массе | — |
| Невидимка | 1.5 сек невидимости после Рывка | Есть Рывок |

### 4.1. Детали эпических талантов

**Молния:**
- +25% к максимальной скорости
- Укусы накладывают оглушение на 0.3 сек
- Оглушённый не может двигаться, поворачивать, кусать, использовать умения

**Двойная активация:**
- Окно повторной активации: 1.0 сек
- Стоимость первой активации: 100%
- Стоимость второй активации: 80%
- Суммарная стоимость: 180%
- См. [GDD-Abilities.md](GDD-Abilities.md), раздел 4

**Взрыв:**
- Радиус отталкивания: 60 м
- Урон всем в радиусе: 8% массы
- Срабатывает в момент гибели
- Месть убийце, а не помощь ему

**Левиафан:**
- Множитель радиуса слайма `leviathanRadiusMul`: ×1.3
- Множитель радиуса пасти `leviathanMouthMul`: ×1.5
- Масса: без изменений
- Хитбокс увеличивается

**Формула радиуса с Левиафаном:**
```
slimeRadius = baseRadiusM × √(mass / baseMassKg) × leviathanRadiusMul
mouthRadius = slimeRadius × (mouthAngle / 360) × leviathanMouthMul
```

Слайм 100 кг с Левиафаном имеет радиус 13 м (вместо 10 м) и пасть 120° × 1.5 = эффективно шире.

**Невидимка:**
- Активируется после использования Рывка
- Длительность: 1.5 сек
- См. [GDD-Combat.md](GDD-Combat.md), раздел 6.3

---

## 5. Классовые таланты

Доступны только соответствующему классу.

### 5.1. Таланты Охотника

| Талант | Эффект | Редкость |
|---|---|---|
| Засада | +30% к урону при атаке в бок или хвост | Редкий |
| Разгон | +5% к скорости за секунду движения (макс +20%) | Редкий |
| Невидимка | 1.5 сек невидимости после Рывка | Эпический |

### 5.2. Таланты Воина

| Талант | Эффект | Редкость |
|---|---|---|
| Несокрушимый | −15% к потере массы при любом уроне | Редкий |
| Шипы | Атакующий теряет 10% от нанесённого урона | Редкий |
| Берсерк | +3% к урону за каждые 100 кг потерь (макс +30%) | Эпический |

### 5.3. Таланты Собирателя

| Талант | Эффект | Редкость |
|---|---|---|
| Паразит | +5% массы сверх обычного при укусе слайма | Редкий |
| Магнит | Пузыри в радиусе 50 м летят к пасти (10 м/с) | Редкий |
| Симбиоз | При укусе слайма +50% пузырей (бонусная масса) | Эпический |

### 5.4. Улучшения классовых талантов

| Талант | Уровень 1 | Уровень 2 |
|---|---|---|
| Магнит | Радиус 50 м, 10 м/с | Радиус 70 м, 15 м/с |

---

## 6. Алгоритмы сложных талантов

### 6.1. Разгон (Охотник)

**Условие активации:** скорость слайма превышает 10% от максимальной.

**Накопление:** каждую секунду непрерывного движения бонус увеличивается на 5 процентных пунктов.

**Максимум:** +20% к скорости (достигается за 4 секунды).

**Сброс:** мгновенный при падении скорости ниже порога.

**Сохранение при гибели:** бонус сбрасывается.

### 6.2. Берсерк (Воин)

**Накопитель:** сервер суммирует всю массу, потерянную игроком за матч из любых источников.

**Расчёт уровней:** каждые 100 кг потерь дают один уровень. Максимум 10 уровней.

**Бонус урона:** количество уровней × 3%.

**Сохранение при гибели:** прогресс НЕ сбрасывается.

**Визуализация:** красное свечение вокруг спрайта. Интенсивность пропорциональна количеству уровней. На максимуме — яркое пульсирующее свечение.

### 6.3. Симбиоз (Собиратель)

**Триггер:** любой успешный укус вражеского слайма.

**Эффект:** при укусе порождается на 50% больше пузырей.

**Источник бонусных пузырей:** генерируются системой, не за счёт массы жертвы.

**Цвет пузырей:** по классу жертвы.

**Синергия:** отлично сочетается с Вакуумом — больше пузырей, которые сразу летят к Собирателю.

---

## 7. Система карточек

### 7.1. Принципы

| Принцип | Реализация |
|---|---|
| Единый интерфейс | Умения и таланты выбираются одинаково |
| Без паузы | Игра продолжается во время выбора |
| Формат | Выбор 1 из 3 карточек |
| Очередь | Максимум 3 отложенных выбора |
| Автовыбор | Через 12 сек бездействия |

### 7.2. События появления карточек

| Событие | Тип карточек |
|---|---|
| Достигнут порог массы (уровни 2, 4, 6+) | 3 таланта |
| Открылся слот умения (уровни 3, 5) | 3 новых умения |
| Все слоты заняты, достигнут порог | 3 таланта или улучшения умений |

**Сундуки не создают карточки** — награда применяется сразу.

### 7.2.1. Распределение редкостей по уровням

Стиль Archero/Survivor.io: ранние уровни — обычные таланты, поздние — шанс на редкие и эпические.

| Уровень | Обычный | Редкий | Эпический |
|---:|---:|---:|---:|
| 2 | 100% | 0% | 0% |
| 3 | 85% | 15% | 0% |
| 4 | 70% | 28% | 2% |
| 5 | 60% | 35% | 5% |
| 6 | 50% | 40% | 10% |
| 7+ | 40% | 45% | 15% |

**Алгоритм:**
1. Определить уровень игрока.
2. Бросить кубик для каждой из 3 карточек.
3. Выбрать редкость по таблице.
4. Если таланты выбранной редкости закончились — понизить редкость.

### 7.3. Правила формирования набора

**Для талантов:**
1. 3 случайных из набора соответствующей редкости.
2. Таланты с требованием умения показываются только при наличии этого умения.
3. Запрет на 3 карточки одного типа эффекта.
4. Классовые таланты — только для своего класса.
5. **Гарантия:** хотя бы 1 классовый талант в наборе (если доступен).

**Для умений при открытии слота:**
1. 3 случайных из общего набора.
2. Только умения, которых у игрока ещё нет.
3. Улучшения не показываются.

**Для улучшений (все слоты заняты):**
1. Улучшения имеющихся умений, не достигших максимального уровня.
2. Могут смешиваться с талантами.

**Правило смешивания:** минимум 1 талант в наборе. Остальные 2 — случайный выбор между талантами и улучшениями.

### 7.4. Очередь выборов

| Параметр | Значение |
|---|---|
| Максимум элементов `cardQueueMax` | 3 |
| Таймер на элемент `cardAutoPickSec` | 12 сек |

- При переполнении — принудительный автовыбор для старшего элемента.
- Таймер продолжает идти при свёрнутых карточках.
- Первым обрабатывается самый старый элемент.
- Таймеры приостанавливаются на время возрождения (2 сек).

### 7.5. Автовыбор

Система оценивает каждую карточку по категориям приоритета класса.

| Класс | Приоритет 1 (×3) | Приоритет 2 (×2) | Приоритет 3 (×1) |
|---|---|---|---|
| Охотник | Скорость, манёвренность | Урон | Защита |
| Воин | Защита, живучесть | Урон | Скорость |
| Собиратель | Сбор, масса | Защита | Скорость |

**Алгоритм:**
1. Каждой карточке присваивается оценка по категориям.
2. Оценки умножаются на вес категории.
3. Выбирается карточка с максимальной суммой.
4. При равенстве — случайный выбор.

---

## 8. Взаимодействие талантов и умений

### 8.1. Вакуум (талант) + Притяжение (умение)

Оба эффекта притягивают пузыри. Правила совмещения:

| Параметр | Правило |
|---|---|
| Радиус | Берётся **максимум** из двух |
| Скорость притяжения | Берётся **максимум** из двух |
| Эффекты | **Не складываются** |

**Пример:**
- Вакуум уровень 2: радиус 60 м, скорость 20 м/с
- Притяжение уровень 1: радиус 120 м, скорость 50 м/с
- **Результат:** радиус 120 м, скорость 50 м/с

### 8.2. Магнит (талант) + Вакуум (талант)

| Параметр | Правило |
|---|---|
| Радиус | Берётся **максимум** |
| Скорость | Берётся **максимум** |

Магнит — пассивный (всегда активен), Вакуум — пассивный. Результирующий эффект = максимум из двух.

### 8.3. Общее правило

**Эффекты одного типа не стекаются.** Применяется наиболее сильный эффект:
- Притяжение пузырей: максимум радиуса и скорости.
- Замедление: суммируется (до лимита 80%).
- Урон: стекается (все бонусы применяются).

---

## Связанные документы

- [GDD-Core.md](GDD-Core.md) — основные правила
- [GDD-Combat.md](GDD-Combat.md) — бой и механики
- [GDD-Abilities.md](GDD-Abilities.md) — умения
- [GDD-Chests.md](GDD-Chests.md) — сундуки и усиления
