# Slime Arena — Arena

**Версия:** 3.3  
**Дата:** 28.12.2025  
**Зависимости:** GDD-Core.md (физика, фазы)  
**Глоссарий:** [GDD-Glossary.md](GDD-Glossary.md)

---

## 1. Размеры карт

### 1.1. Варианты

| Размер | Ширина × Высота | Игроков |
|---|---:|---:|
| Малая | 800 × 800 м | 10–15 |
| Средняя | 1200 × 1200 м | 15–20 |
| Большая | 1600 × 1600 м | 20–30 |

### 1.2. Форма арены

- Арена прямоугольная.
- Границы упругие (отскоки от стен).
- Углы карты — тактически важные точки.

### 1.3. Коэффициент восстановления

| Параметр | Значение |
|---|---|
| `restitution` | 0.3 |

---

## 2. Зоны

### 2.1. Типы зон

| Зона | Эффект | Цвет | Индикация |
|---|---|---|---|
| Нектар | +1% массы в секунду | Жёлто-зелёный | Позитивная |
| Лёд | Коэффициент трения ×0.3 | Голубой | Нейтральная |
| Слизь | Скорость ×0.5, трение ×2 | Фиолетовый | Нейтральная |
| Лава | −2% массы в секунду | Оранжево-красный, мигающий | **ОПАСНОСТЬ** |
| Турбо | Скорость ×1.4 | Синий | Позитивная |

### 2.2. Цветовая индикация опасности

| Тип зоны | Цвет | Эффекты |
|---|---|---|
| Позитивные | Зелёный, синий | Статичные, мягкое свечение |
| Нейтральные | Голубой, фиолетовый | Статичные |
| Опасные | Красный, оранжевый | **Мигающий контур, иконка черепа** |

Опасные зоны (Лава, Шипы) дополнительно подсвечиваются красным мигающим контуром для привлечения внимания.

### 2.3. Параметры зон

| Зона | Параметр | Значение |
|---|---|---|
| Нектар | Прирост массы | +1% в сек |
| Лёд | Коэффициент трения | ×0.3 |
| Слизь | Максимальная скорость | ×0.5 |
| Слизь | Коэффициент трения | ×2.0 |
| Лава | Потеря массы | −2% в сек |
| Турбо | Максимальная скорость | ×1.4 |

### 2.4. Правила потерь в зонах

При потере массы от зоны (Лава) 50% потерянной массы выбрасывается в виде мелких пузырей цвета класса слайма.

---

## 3. Препятствия

### 3.1. Типы препятствий

| Элемент | Свойство |
|---|---|
| Узкий проход | Ширина 25 м, слаймы тяжелее 350 кг не проходят |
| Столб | Непроходим, укрытие |
| Шипы | Потеря 5% массы при касании |

### 3.2. Узкий проход

- Ширина: 25 м
- Ограничение массы: 350 кг
- Слаймы тяжелее 350 кг не могут пройти
- Создаёт тактические точки для мелких слаймов

### 3.3. Столб

- Непроходимый объект
- Работает как укрытие от снарядов
- Слаймы отскакивают при столкновении

### 3.4. Шипы

- Урон при касании: 5% массы
- Срабатывает мгновенно при контакте
- Неуязвимость после урона не применяется

---

## 4. Безопасные зоны (финал)

### 4.1. Назначение

Безопасные зоны — области в финале матча, где слаймы защищены от урона. Вне зон слаймы теряют массу.

### 4.2. Параметры

| Параметр | Значение |
|---|---|
| Время активации | Последние 60 сек матча (120–180 сек) |
| Количество зон | 1–3 (зависит от размера карты) |
| Урон вне зоны | 1–2% массы в секунду |

### 4.3. Количество по размеру карты

| Размер карты | Безопасных зон |
|---|---:|
| Малая | 1 |
| Средняя | 1–2 |
| Большая | 2–3 |

### 4.4. Индикация

1. **Предупреждение:** за 10 сек до активации с миганием.
2. **Стрелка:** на границе экрана указывает направление к ближайшей зоне.
3. **Пузыри:** появление 5 пузырей при активации.
4. **Звук:** позитивный звуковой сигнал.

### 4.5. Визуализация

- **Цвет зоны:** мягко-зелёный (позитивный, безопасный).
- Зоны пульсируют в последние 60 секунд.
- Пульсация краёв экрана при нахождении ВНЕ безопасной зоны.
- Зоны видны на мини-карте зелёным цветом.

---

## 5. Безопасная зона возрождения

### 5.1. Параметры

| Параметр | Значение |
|---|---|
| Радиус | 150 м |
| Условие | Нет врагов в радиусе |

### 5.2. Правила

- Игрок возрождается в точке, где в радиусе 150 м нет вражеских слаймов.
- Если такой точки нет — выбирается максимально удалённая от врагов.

---

## 6. Пузыри карты

Параметры пузырей (фазы, цвета, масса) описаны в [GDD-Core.md](GDD-Core.md), раздел 4.

### 6.1. Правила появления на арене

- Пузырь не может появиться внутри препятствия.
- Пузырь не может появиться внутри опасной зоны (Лава, Шипы).
- Пузырь появляется в случайной точке на карте.
- `spawnRetryCount = 10` попыток найти точку.

---

## 7. Сундуки на карте

Параметры сундуков описаны в [GDD-Chests.md](GDD-Chests.md), раздел 2.

---

## 8. Динамика фаз

### 8.1. Фаза Рост (0–60 сек)

- Много мелких пузырей
- Спокойный сбор массы
- Все набирают базовую массу
- Сундуки: в основном `rare`

### 8.2. Фаза Охота (60–120 сек)

- Меньше пузырей, но крупнее
- Появляются красные пузыри
- Начинается конкуренция
- Сундуки: `rare` и `epic`

### 8.3. Фаза Финал (120–180 сек)

- Мало пузырей, но ценные
- Золотые пузыри
- Безопасные зоны активны
- Каждый пузырь важен
- Сундуки: все типы, включая `gold`

---

## 9. Генерация случайной арены

### 9.1. Общие правила

Арена генерируется случайно при создании комнаты.

| Параметр | Диапазон |
|---|---|
| Размер | Малая / Средняя / Большая (случайно или по настройке) |
| Количество зон | 0–5 |
| Количество препятствий | 3–10 |
| Количество безопасных зон | 1–3 (по размеру карты) |

### 9.2. Алгоритм генерации

1. Выбрать размер арены.
2. Разместить безопасные зоны (для финала):
   - Минимальное расстояние между зонами: 200 м.
   - Зоны не на краях карты.
3. Разместить зоны эффектов:
   - Тип выбирается случайно.
   - Зоны не пересекаются.
   - Лава не ближе 100 м к точке спавна.
4. Разместить препятствия:
   - Не блокировать проходы полностью.
   - Минимум 2 узких прохода на средней/большой карте.
5. Валидация: проверить проходимость между любыми двумя точками.

### 9.3. Ограничения

- Лава занимает не более 10% площади карты.
- Нектар занимает не более 5% площади карты.
- Минимум 60% карты — свободное пространство.

---

## Связанные документы

- [GDD-Core.md](GDD-Core.md) — основные правила
- [GDD-Chests.md](GDD-Chests.md) — сундуки и усиления
- [GDD-UI.md](GDD-UI.md) — интерфейс
