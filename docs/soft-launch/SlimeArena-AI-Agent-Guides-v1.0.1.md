# Slime Arena — Инструкции для ИИ-агентов (кодеры и тестировщики)

**Версия:** 1.0.1  
**Дата:** 5 января 2026  

---

## 1. Общий режим работы

По умолчанию агент работает в режиме **диагностики**.

1. `[MUST]` Сначала найти требование/контракт, которому противоречит поведение (ссылка на `REQ-*`, `ACC-*`, или раздел документа).
2. `[MUST]` Сформулировать проблему и её влияние на релиз (блокирует / не блокирует).
3. `[MUST]` Предложить минимальное исправление.
4. `[MUST]` Описать проверки, которые подтверждают исправление.
5. `[MUST]` Не менять код, если явно не попросили «внести правку» или «сделать PR/патч».
6. `[MUST]` При расхождении требований между документами сообщить оператору и указать конфликтующие места. Самостоятельно выбирать «как правильнее» запрещено.
   Приоритет источников правды: (1) Архитектура часть 4/4 → (2) ТЗ Soft Launch → (3) План Soft Launch → (4) Архитектура части 1–3 → (5) прочие документы.

Запрещено:
- «улучшать» стиль, форматирование, архитектуру без запроса.
- массово переименовывать, переносить файлы, менять публичные контракты.
- добавлять новые зависимости без запроса.
- исправлять «заодно» несвязанные места.

---

## 2. Инструкция для ИИ-кодера

### 2.1. Формат ответа в режиме диагностики

1. Заголовок: кратко «что сломано».
2. Источник правды: ссылка на документ/раздел/REQ.
3. Локализация: модуль/файл/endpoint/таблица.
4. Гипотеза причины.
5. Минимальное исправление (шаги 1…N, без кода).
6. Риски.
7. Проверки (какие тесты/скрипты/смоук прогнать).
8. Что НЕ трогать.

### 2.2. Правила правок (если правка разрешена)

1. `[MUST]` Делать только минимально необходимое, чтобы выполнить конкретное `REQ` или исправить дефект.
2. `[MUST]` Не менять API и схему БД без изменения документов-источников правды.
3. `[MUST]` Все операции с ценностью сохранять идемпотентными (`operationId`).
4. `[SHOULD]` Добавлять защитные проверки и логирование только вокруг места дефекта.
5. `[MUST]` В описании результата перечислить, какие `ACC-*` теперь выполняются.

---

## 2.3. Приоритеты исправления дефектов

1. **P0 (блокирующие релиз):** потеря данных экономики, нарушение идемпотентности, недоступность `auth`/`matchmaking`, критические падения `MatchServer`.
2. **P1 (критичные для софт-лонча):** деградация очереди, ошибки конфигов, массовые разрывы и невозможность переподключения.
3. **P2 (желательные):** UI дефекты WebView/`iframe`, вторичные события аналитики, локальные оптимизации без изменения контрактов.

## 3. Инструкция для ИИ-тестировщика

### 3.1. Формат ответа

1. Какие требования покрываем (REQ/ACC).
2. Набор тестов:
   - smoke
   - регрессия экономики
   - негативные сценарии (повторы, таймауты, неверные данные)
3. Для каждого теста:
   - шаги
   - ожидаемый результат
   - какие логи/метрики подтверждают результат

### 3.2. Приоритеты тестирования для Soft Launch

1. `[MUST]` Операции с ценностью: покупки, выдачи, реклама с наградой.
2. `[MUST]` Матчмейкинг: `join/status/cancel`, таймауты, повторные запросы.
3. `[MUST]` Устойчивость: разрыв WebSocket, повтор входа, падение `MatchServer`.
4. `[SHOULD]` UI в WebView/`iframe`: `safe-area`, кнопка «назад», изменение размеров окна.

### 3.3. Правила отчёта об ошибке

1. `[MUST]` Указать симптом и точные шаги воспроизведения.
2. `[MUST]` Указать ожидаемое поведение со ссылкой на REQ/ACC.
3. `[MUST]` Указать фактическое поведение и артефакты (логи/метрики/скриншоты).
4. `[MUST]` Классифицировать: блокирует релиз / не блокирует.
5. `[MUST]` Не предлагать «большой рефакторинг» как решение дефекта.



---

## 4. Примеры допустимых и недопустимых действий

### 4.1. Допустимо

1. Найти конкретное `REQ-*`/`ACC-*`, которое нарушено, и предложить минимальную правку, затрагивающую только место дефекта.
2. Добавить проверку входных данных для маршрута, если это требуется Приложением F.
3. Добавить тест на повтор `operationId`, если найден дубликат выдачи.

### 4.2. Недопустимо

1. Переписать модуль целиком «чтобы было красивее», если это не требуется для устранения дефекта.
2. Менять публичные контракты HTTP API или БД без обновления Архитектуры часть 4/4.
3. Добавлять новую библиотеку «для удобства», если это не часть утверждённого стека.
