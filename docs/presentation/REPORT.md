# AI-Driven Game Development: Практическое руководство

Как нетехнический специалист создал production-ready игру за 31 день с AI-агентами.

---

## Что получилось

**Slime Arena** — мобильная PvP-игра с реалтайм мультиплеером.

| Метрика | Значение |
|---------|----------|
| Срок | 31 день |
| Код | 83,050 строк TypeScript |
| Документация | 114 файлов |
| Ускорение | 6-9x (средн.) / 30-40x (пик) |

---

## Настройка среды

### Инструменты

| Инструмент | Назначение |
|------------|------------|
| **VS Code** | Редактор с расширениями Claude Dev / Continue |
| **Cursor** | AI-first редактор (Claude/GPT встроены) |
| **Claude Code** | CLI для Claude API |

### Структура проекта

```
project/
├── CLAUDE.md              ← Правила для агентов
├── .memory_bank/
│   ├── activeContext.md   ← Текущее состояние
│   └── techContext.md     ← Технический стек
└── .beads/
    └── AGENT_ROLES.md     ← Инструкции по ролям
```

### CLAUDE.md (минимальный шаблон)

```markdown
# [Название] — инструкции для Claude

## Главные правила
1. Работай по задачам
2. Пуш в main запрещён — только PR
3. После изменений: npm run build && npm run test

## Критичные ограничения
- [Ограничение 1]
- [Ограничение 2]

## Ключевые файлы
| Файл | Назначение |
|------|------------|
| [путь] | [описание] |
```

---

## Architect как управляющий агент

**Ключевой инсайт:** Выделить одного агента для управления другими.

```
         ARCHITECT (Opus)
              │
    ┌─────────┼─────────┐
    │         │         │
Developer Developer Reviewer
 (Opus)    (Opus)   (Gemini)
```

**Architect:**
- Читает документацию проекта
- Разбивает задачи на подзадачи
- Составляет промпты для Developer
- НЕ пишет код сам

**Почему работает:**
- Architect видит контекст целиком
- Developer получает готовый промпт
- Reviewer — другая модель (избегает слепых пятен)

### Формула успеха: 3 компонента

```
┌─────────────────────────────────────────────────────┐
│  1. Роль + ссылка на AGENT_ROLES.md                 │
│  2. Memory Bank (activeContext, progress)           │
│  3. Короткие чёткие инструкции от Architect         │
└─────────────────────────────────────────────────────┘
```

### Промпт для Architect (планирование)

```
Ты — Architect. Роль: .beads/AGENT_ROLES.md

Нужно добавить функциональность <X>.

1) Прочитай .memory_bank/productContext.md и activeContext.md
2) Найди релевантные разделы в .memory_bank/modules/
3) Составь пошаговый план:
   - шаг
   - ожидаемый результат
   - файлы, которые будут затронуты
   - риски/неопределённости

Не реализуй ничего. Только план.
```

### Промпт для Developer (реализация)

```
Ты — Developer. Роль: .beads/AGENT_ROLES.md

План утверждён. Выполняй шаг 1.

После выполнения:
- опиши, что сделано
- укажи изменённые файлы
- обнови .memory_bank/activeContext.md и progress.md
```

### Промпт для Reviewer (проверка)

```
Ты — Reviewer. Роль: .beads/AGENT_ROLES.md

Проверь PR: [ссылка]

Чеклист:
- [ ] npm run build проходит
- [ ] npm run test проходит
- [ ] Нет hardcoded констант
- [ ] [специфичные проверки проекта]

Формат отчёта в PR:
## Review by [модель]
### Чеклист
### Замечания (P0-P3)
### Вердикт: APPROVED / CHANGES_REQUESTED
```

### Как Architect уточняет промпты

Architect не просто планирует — он составляет готовые промпты для Developer и Reviewer:

```
### Подзадача 1: Извлечь CombatSystem

Промпт для Developer:
"Создай server/src/systems/combatSystem.ts.
Перенеси методы: handleBite, processPvPCollision, applyDamage.
Ограничения: использовать Rng, не Math.random().
Критерий: npm run test проходит."

Промпт для Reviewer:
"Проверь: детерминизм сохранён, порядок систем не изменён,
hardcoded констант нет."
```

---

## 5 инструментов методологии

### 1. Документация как контракт

AI-агенты не помнят контекст между сессиями. Решение — исчерпывающая документация.

**Что нужно:**
- GDD — правила игры, баланс, механики
- Architecture — техническая архитектура
- AGENT_ROLES.md — роли и ограничения агентов

**Принцип:** Документ → Задача → Проверка по документу.

### 2. Zero Trust

AI может галлюцинировать. Не доверять — проверять.

**Пайплайн:**
```
Задача → Код → Build → Test → Review → Merge
    ↑                              │
    └──────── Не прошло? ←─────────┘
```

**Правила:**
- Каждый PR проходит CI
- Мультивендорное ревью (ChatGPT, Gemini, Copilot, Opus)
- Запрет push в main — только через PR

### 3. Memory Bank

Контекст теряется при новой сессии или смене агента.

**Структура `.memory_bank/`:**
```
activeContext.md      ← Что делаем сейчас
techContext.md        ← Технический стек
productContext.md     ← Продуктовый контекст
progress.md           ← История изменений
systemPatterns.md     ← Архитектурные паттерны
```

**Протокол:** Агент начинает с чтения Memory Bank.

### 4. Beads (таск-менеджер)

Git-native issue tracker вместо Jira.

```bash
bd ready              # Готовые задачи
bd show <id>          # Детали
bd update <id>        # Статус
bd close <id>         # Закрыть
```

Данные в `.beads/` — часть репозитория.

### 5. Разделение ролей

| Роль | Делает | Не делает |
|------|--------|-----------|
| Architect | Планирует | Не пишет код |
| Developer | Реализует | Только своя ветка |
| Reviewer | Проверяет | Не мержит |

---

## Типичные грабли

### Git
- Прямой push в main
- Коммит в чужую ветку
- Забыл создать ветку

**Защита:** GitHub branch protection + pre-flight чеклист.

### Код
- `Math.random()` вместо seeded RNG
- Hardcoded константы
- Несуществующие методы API

**Защита:** CI тесты + code review.

### Архитектура
- Изменение порядка систем
- Поле без Schema
- CSS-градиенты на мобильных

**Защита:** Документация + детерминизм-тесты.

---

## Быстрый старт

### Шаг 1: Документация

Создай минимум:
- README с архитектурой
- CLAUDE.md с правилами для агента
- Файл баланса (JSON)

### Шаг 2: Инфраструктура

```bash
# GitHub branch protection
# CI: build + test на каждый PR
# Memory Bank:
mkdir .memory_bank
touch .memory_bank/{activeContext,techContext,progress}.md
```

### Шаг 3: Работа с агентом

1. Агент читает документацию
2. Создаёт ветку: `feature/task-name`
3. Пишет код
4. `npm run build && npm run test`
5. Создаёт PR
6. Ревью от другого агента/модели
7. Человек мержит

### Шаг 4: Параллельная работа

Для нескольких агентов:
```bash
git worktree add ../project-agent1 -b feature/task1
git worktree add ../project-agent2 -b feature/task2
```

Каждый агент в своём worktree = 0 конфликтов.

---

## Чеклист для агента

Вставь в промпт или CLAUDE.md:

```markdown
## Pre-flight чеклист
- [ ] Проверь `git branch` — ты на правильной ветке?
- [ ] Проверь `pwd` — ты в правильной директории?
- [ ] Прочитай Memory Bank перед работой

## Правила кода
- [ ] Случайность только через seeded RNG
- [ ] Константы из config, не hardcode
- [ ] После изменений: `npm run build && npm run test`

## Git правила
- [ ] Никогда `git push origin main`
- [ ] Никогда `git reset --hard` без подтверждения
- [ ] Коммит только в свою ветку
```

---

## Ключевые выводы

1. **Документация обязательна** — агент без контекста бесполезен
2. **Zero Trust всегда** — build, test, review на каждый PR
3. **Memory Bank работает** — 80% сохранение контекста
4. **Разделение ролей** — один агент ≠ универсальный эксперт
5. **Git Worktrees** — параллельная работа без конфликтов

---

## Стоимость

| Сервис | Цена/мес |
|--------|----------|
| Claude API | $20-50 |
| ChatGPT Plus | $20 |
| Copilot | $10-19 |
| **Итого** | $50-100 |

---

## Ссылки

**Статьи (рекомендуемое чтение):**
- [Живая документация проекта через VS Code + Codex + Memory Bank](https://habr.com/ru/articles/979624/) — ключевая статья о методологии
- [Представляем Beads: система памяти для кодинг-агентов](https://habr.com/ru/articles/983498/) — важнейшая статья о сохранении контекста

**Инструменты:**
- [Slime Arena (GitHub)](https://github.com/komleff/slime-arena)
- [Beads](https://github.com/hyperdrive-systems/beads) — Git-native таск-менеджер
- [Claude Code](https://claude.ai/claude-code) — CLI для Claude
- [Cursor](https://cursor.sh) — AI-first редактор
- [Colyseus](https://colyseus.io/) — мультиплеер фреймворк
