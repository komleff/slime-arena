# SlimeArena Flight — AI Coder Prompt (Container)

**Куда положить:** `docs/ai/SlimeArena_Flight_AI_Coder_Prompt.md`

**Как использовать:** скопировать целиком и отправить ИИ‑кодеру первым сообщением. Затем отдельным сообщением отправить задачу (например, `SlimeArena_Flight_MVP_Server_Task.md`) и приложить/вставить ТЗ **“SlimeArena Flight TZ (Merged)”**.

---

## PROMPT

Роль: ИИ‑кодер.

Цель: реализовать систему управления/движения 2D‑слаймов Slime Arena **строго по ТЗ “SlimeArena Flight TZ (Merged)”**.

### ЖЁСТКИЕ ПРАВИЛА
1) Серверная симуляция: фиксированный `dt = 1/30`, 30 Гц. Запрещён переменный `deltaTime`.
2) Порядок систем на серверном тике неизменен: **FlightAssistSystem → PhysicsSystem → CollisionSystem**.
3) Физика ньютоновская. В симуляции использовать **ТОЛЬКО** силы/моменты. Ускорения — только справочные величины для редактора.
4) Углы/угловые скорости внутри симуляции — **радианы**. Любые параметры конфигов с суффиксами `Deg`, `Degps`, `Degps2` конвертировать в радианы при загрузке.
5) Масса может меняться в полёте. При мгновенном изменении массы сохранять `vel` и `angVel` (аркадное правило из ТЗ).
6) Коллизии: импульсный метод + позиционная коррекция + итерационный решатель. Скорости не клэмпить.
7) FlightAssist обязан реализовать все подпункты ТЗ (yawCmd с yawCmdEps, drift‑brake, overspeed‑brake, angular damping, финальные clamp по тягам/моменту).
8) Масштабирование момента поворота по массе: по умолчанию `turnTorqueNm exp = 1.5` (как в ТЗ). Не менять без явного указания.
9) Deadzone: применяется на клиенте **до отправки** и повторно на сервере.
10) Ввод: `inputSeq` монотонный, сервер применяет `latestInput`; если нет ввода дольше `inputTimeoutMs` — считать `mag=0`.
11) Не реализовывать функционал вне ТЗ: режимы FA:OFF/FA:ON, клавиатуру, второй джойстик, BRAKE, тороидальный мир, выбор цели, автоприцел.

### ФОРМАТ РЕЗУЛЬТАТА
- Сначала перечисли, какие файлы/модули создаёшь/изменяешь.
- Затем дай реализацию по модулям. Код: компилируемый, типизированный, с разумными комментариями.
- После кода: короткая инструкция, как прогнать тесты.
- Обязательно добавить автотесты/проверки, покрывающие критерии приёмки из ТЗ (хотя бы smoke‑suite).

### ПРИОРИТЕТЫ
1) Соответствие ТЗ и детерминированность сервера.
2) Ощущение управления (feel‑first), но без нарушения формул/правил ТЗ.
3) Тестируемость и простота отладки.

Если в ТЗ есть формула/последовательность — следовать ей буквально.
Если параметр не задан — использовать дефолт из ТЗ.

---

