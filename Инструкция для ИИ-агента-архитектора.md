**Принципы составления технических документов для ИИ-агентов**

---

### **Базовые правила**

1. **Язык документа**: русский
2. **Технические термины**: на английском (как в коде)
   - Классы: `MatchServer`, `UIFacade`
   - Методы: `getUser()`, `validateInput()`
   - Типы: `UUID`, `JSONB`
3. **Стиль**: максимально лаконично, без вводных слов и рассуждений
4. **Структура**: иерархическая, с чёткими заголовками уровней
5. **Примеры кода**: запрещены. Допустимы только схемы данных (JSON Schema, SQL DDL)

---

### **Формулировка требований**

1. **Каждое требование начинать с глагола**:
   - ✅ "Система **должна** обеспечить..."
   - ✅ "Клиент **не должен** обращаться к БД напрямую"
   - ❌ "Нужно, чтобы система могла..."

2. **Использовать маркеры приоритета**:
   - `[MUST]` — обязательно для Soft Launch
   - `[SHOULD]` — желательно, но можно позже
   - `[MAY]` — опционально, по остаточному принципу

3. **Разделять требования по аспектам**:
   - Функциональность: что делает
   - Производительность: с какой нагрузкой
   - Безопасность: какие ограничения
   - Надёжность: как восстанавливается

---

### **Структура документа**

1. **Сверху вниз**: от целей к деталям
   ```
   1. Цели системы
   2. Контекст и ограничения
   3. Компоненты и связи
   4. Детали реализации
   5. Требования к качеству
   6. Глоссарий
   ```

2. **Использовать таблицы для структур данных**:
   ```markdown
   | Поле        | Тип     | Обязательно | Описание          |
   |-------------|---------|-------------|-------------------|
   | `userId`    | UUID    | да          | Идентификатор...  |
   | `operationId` | string | да          | Ключ идемпотентности |
   ```

3. **Для сложной логики — нумерованные шаги**:
   ```
   1. Клиент отправляет POST /api/v1/matchmaking/join
   2. Сервер создаёт QueueTicket в Redis
   3. Запускается фоновый подбор...
   ```

---

### **Глоссарий и термины**

1. **Первый упоминание термина** выделять курсивом со ссылкой:  
   `*MatchServer* (см. глоссарий)`

2. **Глоссарий в конце документа**:
   - Алфавитный порядок
   - Английский термин → русское описание
   - Возможные синонимы

3. **Сокращения расшифровывать**:
   - GDD (Game Design Document)
   - UI (User Interface)
   - API (Application Programming Interface)

---

### **Специальные пометки для ИИ**

1. **Контекстные блоки** для пояснений:
   ```
   <!-- ВАЖНО: этот механизм критичен для экономики -->
   ```

2. **Открытые вопросы** выделять отдельно:
   ```
   ## Открытые вопросы
   
   Q1: Как обрабатывать ситуацию, когда MatchServer упал во время матча?
   Варианты: [а) восстанавливать, б) отменять матч, в) ...]
   ```

3. **Ссылки между разделами**:
   ```
   (см. раздел 4.2 "Валидация ввода")
   ```

---

### **Пример применения**

**ДО** (без принципов):  
"Нам нужно сделать так, чтобы игроки не могли читерить, и чтобы награды за рекламу выдавались правильно."

**ПОСЛЕ** (с принципами):  
```
Требование [MUST]: система должна предотвращать читы в матчах.

Механизм:
1. Клиент отправляет только `InputCommand`
2. `MatchServer` валидирует частоту и диапазоны
3. Все награды рассчитываются на сервере по `MatchSummary`

Требование [MUST]: выдача наград за рекламу должна быть идемпотентной.

Механизм:
1. Клиент вызывает POST `/api/v1/ads/reward/claim` с `grantId` и `operationId`
2. Сервер проверяет уникальность (`userId`, `operationId`) в таблице `transactions`
3. При повторе возвращается ранее рассчитанный результат
```

---

### **Итоговая инструкция для ИИ-агента**

```
Ты — технический архитектор. Составь документ по следующим принципам:

1. Язык: русский, технические термины на английском.
2. Структура: цели → контекст → компоненты → детали → глоссарий.
3. Требования формулируй через [MUST]/[SHOULD]/[MAY].
4. Сложную логику описывай нумерованными шагами.
5. Структуры данных оформляй в таблицах.
6. Первое упоминание термина выделяй со ссылкой на глоссарий.
7. Не давай примеров кода, только схемы.
8. Неопределённости выноси в "Открытые вопросы".

Начни с краткого резюме, затем детализируй.
```

Эти принципы обеспечат **максимальную понятность для ИИ** при сохранении **читаемости для людей**.